(this["webpackJsonpkozi-frontend"]=this["webpackJsonpkozi-frontend"]||[]).push([[0],{208:function(e,t,a){e.exports=a.p+"static/media/map-floor-3.47d1f062.png"},209:function(e,t,a){e.exports=a.p+"static/media/kozi-isaac-logo.df9a5e3a.png"},214:function(e,t,a){e.exports=a.p+"static/media/kozi-isaac-logo.df9a5e3a.png"},215:function(e,t,a){e.exports=a(352)},230:function(e,t,a){},231:function(e,t,a){},236:function(e,t){},238:function(e,t){},252:function(e,t){},254:function(e,t){},282:function(e,t){},284:function(e,t){},285:function(e,t){},291:function(e,t){},293:function(e,t){},311:function(e,t){},313:function(e,t){},325:function(e,t){},328:function(e,t){},347:function(e,t,a){},348:function(e,t,a){e.exports=a.p+"static/media/OpenSans-Regular.3ed9575d.ttf"},349:function(e,t,a){},350:function(e,t,a){},352:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(38),o=a.n(r),c=a(15),s=a(91),i=a(39),m=a(357);function u(){var e=Object(s.a)(["\n  {\n    MeanClimateMeasurements {\n      floor\n      loc_x\n      loc_y\n      temperature\n      humidity\n    },\n    SensorFaults {\n      id\n      loc_x\n      loc_y\n      floor\n      timestamp\n    }\n  }\n  \n"]);return u=function(){return e},e}var d=Object(i.gql)(u());function f(){var e=Object(i.useQuery)(d,{pollInterval:1e4}),t=e.data,a=e.loading;if(e.error)return l.a.createElement("h1",null,"Something went wrong. Please try again");if(a)return l.a.createElement("div",{className:"d-flex"},l.a.createElement(m.a,{className:"mx-auto",animation:"border",role:"status"}," "));var n=t.MeanClimateMeasurements.filter((function(e){return!t.SensorFaults.some((function(t){return e.loc_x===t.loc_x&&e.loc_y===t.loc_y&&e.floor===t.floor}))})),r=t.SensorFaults;return l.a.createElement("div",null,l.a.createElement(x,{workingSensors:n,faultySensors:r}),l.a.createElement(F,{workingSensors:n}))}var p=function(){return l.a.createElement("main",null,l.a.createElement(c.d,null,l.a.createElement(c.b,{path:"/login",component:U}),l.a.createElement(c.b,{exact:!0,path:"/",component:f}),l.a.createElement(c.b,{path:"*",component:function(){return l.a.createElement("div",null,"error not found")}})))},E=(a(229),Object(c.h)((function(e){var t=e.location;return l.a.createElement("div",null,"/login"!==t.pathname&&l.a.createElement(C,null),l.a.createElement(p,null))}))),g=a(358),h=a(359),b=a(360),v=a(208),N=a.n(v),x=(a(230),function(e){var t=e.workingSensors,a=e.faultySensors;return l.a.createElement(g.a,{fluid:!0},l.a.createElement(h.a,{className:"justify-content-center"},l.a.createElement(b.a,{xs:11,lg:10,className:"p-0"},t.map((function(e){return l.a.createElement(I,Object.assign({key:[e.loc_x,e.loc_y,e.floor].join("-")},e,{cellHeight:100/14,cellWidth:3.125}))})),a.map((function(e){return l.a.createElement(I,Object.assign({key:[e.loc_x,e.loc_y,e.floor].join("-")},e,{cellHeight:100/14,cellWidth:3.125,faulty:!0}))})),l.a.createElement("img",{className:"w-100",src:N.a,alt:"Map"}))))}),y=a(363),w=a(362),k=a(361),_=(a(231),a(209)),O=a.n(_),S=a(48),j=a(232),R=function(){var e=Object(n.useState)(null),t=Object(S.a)(e,2),a=t[0],l=t[1],r=localStorage.getItem("token"),o=j.decode(r);return o&&!a&&l({email:o.email,logout:function(){localStorage.removeItem("token"),l(!1)},refresh:function(){l(!1)}}),a};function C(){var e=Object(c.g)(),t=R();return l.a.createElement(g.a,{fluid:!0,className:"px-0 pb-5"},l.a.createElement("link",{href:"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css",rel:"stylesheet"}),l.a.createElement(y.a,{className:"d-flex",style:{background:"white",minHeight:120},expand:"lg"},l.a.createElement("div",{style:{flex:1}},l.a.createElement(y.a.Brand,{className:"screen-center"},l.a.createElement("img",{alt:"Kozi Isaac logo",src:O.a,width:"300px",className:"align-top logo img-fluid"}))),t&&l.a.createElement(w.a,null,l.a.createElement(k.a,null,l.a.createElement(k.a.Toggle,{className:"font-weight-bold",variant:"none"},t.email),l.a.createElement(k.a.Menu,{alignRight:!0},l.a.createElement(k.a.Item,{onClick:t.logout},"Log out")))),!t&&l.a.createElement(w.a,null,l.a.createElement("div",{onClick:function(){e.push("/login")},className:"text-center"},l.a.createElement("i",{className:"fa fa-sign-in link-icon btn","aria-hidden":"true"}),l.a.createElement("strong",null,l.a.createElement(w.a.Link,{href:"login",className:"link-text text-decoration-none"},"Login"))))))}a(347);var F=function(e){var t=e.workingSensors,a=(t.reduce((function(e,t){return e+t.temperature}),0)/t.length).toFixed(1)||0,n=(t.reduce((function(e,t){return e+t.humidity}),0)/t.length).toFixed(1)||0;return l.a.createElement(g.a,null,l.a.createElement(h.a,{lg:"8",xl:"7",className:"justify-content-center"},l.a.createElement(b.a,{className:"widget "},l.a.createElement("h1",{className:"value"},t.length),l.a.createElement("p",{className:"description"},"Active sensors")),l.a.createElement(b.a,{className:"widget"},l.a.createElement("h1",{className:"value"},a,"\xb0C"),l.a.createElement("p",{className:"description"},"Avg.Temp")),l.a.createElement(b.a,{className:"widget"},l.a.createElement("h1",{className:"value"},n,"%"),l.a.createElement("p",{className:"description"},"Avg.Hum"))))},L=(a(348),a(349),a(366)),T=a(364);var M=function(e){return""===e.fault_code?l.a.createElement(L.a,{transition:null,show:e.show,target:e.target,placement:"top",containerPadding:20},l.a.createElement(T.a,{id:"popover-contained"},l.a.createElement(T.a.Title,{className:"text-nowrap",style:{backgroundColor:"#349CDB",color:"#ffffff"},as:"h3"},"Sensor Information"),l.a.createElement(T.a.Content,null,l.a.createElement("strong",null,"Floor:")," ",e.floor,l.a.createElement("br",null),l.a.createElement("strong",null,"X:")," ",e.loc_x+" ",l.a.createElement("strong",null,"Y:")," ",e.loc_y,l.a.createElement("br",null),l.a.createElement("strong",null,"T:")," ",(Math.round(100*e.temperature)/100).toFixed(1)+" \xb0C ",l.a.createElement("strong",null,"H:")," ",(Math.round(100*e.humidity)/100).toFixed(1)))):l.a.createElement(L.a,{transition:null,show:e.show,target:e.target,placement:"top",containerPadding:20},l.a.createElement(T.a,{id:"popover-contained"},l.a.createElement(T.a.Title,{className:"text-nowrap",style:{backgroundColor:"#C12D3F",color:"#ffffff"},as:"h3"},"Sensor Information"),l.a.createElement(T.a.Content,null,l.a.createElement("strong",null,"An unexpected error occured:"),l.a.createElement("br",null),function(e){switch(e){case"ERROR_TEMPERATURE_OUT_OF_RANGE":return"Temperature was unreasonably high or low";case"ERROR_TEMPERATURE_DIFFERENCE_MORE_THAN_2_CELSIUS":return"Temperature changed abruptly";case"ERROR_NOT_ENOUGH_VALID_ENTRIES":return"Sensor did not send enough temperature measurements";default:return"Unknown error..."}}(e.fault_code))))};function I(e){var t=e.floor,a=e.loc_x,r=e.loc_y,o=e.faulty,c=e.fault_code,s=e.cellHeight,i=void 0===s?3.125:s,m=e.cellWidth,u=void 0===m?100/14:m,d=e.temperature,f=void 0===d?0:d,p=e.humidity,E=Object(n.useState)(!1),g=Object(S.a)(E,2),h=g[0],b=g[1],v=Object(n.useState)(null),N=Object(S.a)(v,2),x=N[0],y=N[1],w=Object(n.useRef)(null),k=function(e){b(!0),y(e.target)},_=function(e){b(!1)};return o?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{onMouseEnter:k,onMouseLeave:_,className:"sensor faulty-sensor",style:{position:"absolute",left:(a-1.25)*u+"%",top:(r-1.25)*i+"%",width:u+"%",height:i+"%"}},l.a.createElement("span",null,"!"),l.a.createElement(M,{show:h,target:x,floor:t,fault_code:c,loc_x:a,loc_y:r}))):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{ref:w,onMouseEnter:k,onMouseLeave:_,className:"sensor working-sensor",style:{position:"absolute",left:(a-1.25)*u+"%",top:(r-1.25)*i+"%",width:u+"%",height:i+"%"}},l.a.createElement("span",null,f.toFixed(1)+"\xb0C"),l.a.createElement(M,{show:h,target:x,floor:t,temperature:f,fault_code:"",humidity:p,loc_x:a,loc_y:r})))}a(350);var A=a(214),P=a.n(A),z=a(365);function H(){var e=Object(s.a)(["\n  query Login($email: String, $password: String) {\n    Login(email: $email, password: $password) {\n      accessToken\n      error\n    }\n  }\n"]);return H=function(){return e},e}var D=Object(i.gql)(H());function U(){var e=Object(c.g)(),t=Object(n.useState)(null),a=Object(S.a)(t,2),r=a[0],o=a[1],s=R(),m=Object(i.useLazyQuery)(D),u=Object(S.a)(m,2),d=u[0],f=u[1],p=f.error,E=f.data;return s?l.a.createElement(c.a,{to:"/"}):E&&E.Login.accessToken?(localStorage.setItem("token",E.Login.accessToken),l.a.createElement(c.a,{to:"/"})):(E&&E.Login.error&&E.Login.error!==r&&o(E.Login.error),p&&console.log(p),l.a.createElement("div",{className:"main-login"},l.a.createElement("small",null," ",s&&s.email," "),l.a.createElement("link",{href:"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css",rel:"stylesheet"}),l.a.createElement("div",{className:"d-md-flex h-md-100 align-items-center"},l.a.createElement("div",{className:"col-md-6 pt-md-5 p-0 h-md-100 "},l.a.createElement("div",{className:"text-white  d-md-flex h-100 p-5"},l.a.createElement("div",{className:"p-md-5 pb-5"},l.a.createElement("div",{className:"d-flex justify-content-center align-items-center"},l.a.createElement("div",{className:"col-10 col-md-10"},l.a.createElement("img",{className:"img img-fluid",src:P.a,alt:"logo"}))),l.a.createElement("hr",null),l.a.createElement("p",{className:"text-p-secondary h2 mt-5"},"Login"),l.a.createElement("form",{className:"mt-3",onSubmit:function(e){e.preventDefault(),d({variables:{email:e.target.elements.email.value,password:e.target.elements.password.value}})}},l.a.createElement("label",{htmlFor:"email",className:"text-p-secondary"},"Email"),l.a.createElement("div",{className:"input-group"},l.a.createElement("div",{className:"input-group-prepend"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement("i",{className:"fa fa-envelope","aria-hidden":"true"}))),l.a.createElement("input",{type:"email",name:"email",className:"form-control"})),l.a.createElement("label",{htmlFor:"email",className:"text-p-secondary mt-4"},"Password"),l.a.createElement("div",{className:"input-group"},l.a.createElement("div",{className:"input-group-prepend"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement("i",{className:"fa fa-unlock-alt","aria-hidden":"true"}))),l.a.createElement("input",{type:"password",name:"password",className:"form-control"})),l.a.createElement(z.a,{className:"mt-4",show:r,variant:"info"}," ",r," "),l.a.createElement("div",{className:"col-xl-6"},l.a.createElement("button",{id:"submitAction",type:"submit",className:"btn btn-p-primary btn-block btn-round mt-5  "},l.a.createElement("span",{id:"main-executeAction",className:"text-p-primary text-font-primary"},"Login")))),l.a.createElement("div",{className:"col-xl-6"},l.a.createElement("button",{id:"main-forgottenPassword",type:"submit",className:"btn btn-p-primary btn-block btn-round mt-3"},l.a.createElement("span",{className:"text-p-primary text-font-secondary"},"Forgotten Password")))))),l.a.createElement("div",{className:"col-md-6 bg-blue "},l.a.createElement("div",{className:"d-flex flex-column align-items-center h-md-100  p-5 justify-content-center"},l.a.createElement("h1",{id:"side-action",className:"h1 text-white"},"Guest"),l.a.createElement("p",{id:"side-description",className:"text-white h4 text-center"},"Enter to view real-time sensor information!"),l.a.createElement("a",{href:"/",id:"switcher",onClick:function(t){t.preventDefault(),e.push("")},className:"btn btn-round btn-switcher btn-lg btn-block mt-3"},"Login as a guest"))))))}var q=a(58),$=new i.ApolloClient({uri:"https://kozi-backend.herokuapp.com/graphql",cache:new i.InMemoryCache}),B=document.getElementById("root");o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(i.ApolloProvider,{client:$},l.a.createElement(q.a,{basename:"/kozi-frontend"},l.a.createElement(E,null)))),B)}},[[215,1,2]]]);
//# sourceMappingURL=main.a5c15f41.chunk.js.map